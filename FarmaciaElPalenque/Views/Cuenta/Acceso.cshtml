@{
    ViewData["Title"] = "Acceso";
    var returnUrl = Context.Request.Query["returnUrl"].ToString();
    ViewData["ReturnUrl"] = string.IsNullOrEmpty(returnUrl) ? (ViewBag.ReturnUrl ?? "") : returnUrl;
}

@section Styles {
    <style>
        .auth-wrap {
            background: #f6f9fc;
            padding: 2rem;
            border-radius: 1rem;
        }

        .auth-card {
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0,0,0,.06);
            padding: 1.5rem;
        }

        .benefit {
            border: 1px solid #eef2f7;
            border-radius: .75rem;
            padding: 1rem;
            text-align: center;
        }

            .benefit i {
                font-size: 1.3rem;
                margin-bottom: .25rem;
                display: block;
            }

        .btn-dark-pill {
            background: #2f2f2f;
            border: none;
            border-radius: 2rem;
            padding: .75rem 1.5rem;
        }
    </style>
}

<div class="container my-4">
    <div class="auth-wrap">
        <div class="row g-4">
            <div class="col-12 col-lg-6">
                <div class="auth-card h-100">
                    <h4 class="mb-1">Ya tengo una cuenta</h4>
                    <p class="text-muted mb-3">Para iniciar sesión ingresá tu email y contraseña.</p>

                    @await Html.PartialAsync("/Views/Shared/Account/_LoginForm.cshtml",
                    new FarmaciaElPalenque.Models.Usuario())
                </div>
            </div>

            <div class="col-12 col-lg-6">
                <div class="auth-card h-100 d-flex flex-column">
                    <h4 class="mb-1">Crear cuenta</h4>
                    <p class="text-muted mb-3">Creá una cuenta y aprovechá los beneficios.</p>

                    <!--
                    <div class="row g-3 mb-3">
                        <div class="col-6 col-md-3"><div class="benefit"><i class="bi bi-basket"></i>Compra rápida</div></div>
                        <div class="col-6 col-md-3"><div class="benefit"><i class="bi bi-heart"></i>Guardado</div></div>
                        <div class="col-6 col-md-3"><div class="benefit"><i class="bi bi-box-seam"></i>Seguimiento</div></div>
                        <div class="col-6 col-md-3"><div class="benefit"><i class="bi bi-list-check"></i>Datos guardados</div></div>
                    </div>
                    -->

                    <div class="flex-grow-1">
                        @await Html.PartialAsync("/Views/Shared/Account/_RegisterForm.cshtml",
                                                new FarmaciaElPalenque.Models.Usuario { rol = "Cliente" })
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // OJO login
        (function () {
            const btn = document.getElementById('togglePasswordLogin');
            const input = document.getElementById('passwordHashLogin');
            const icon = btn ? btn.querySelector('i') : null;
            if (btn && input) {
                btn.addEventListener('click', function () {
                    const isPwd = input.type === 'password';
                    input.type = isPwd ? 'text' : 'password';
                    if (icon) { icon.classList.toggle('bi-eye', isPwd); icon.classList.toggle('bi-eye-slash', !isPwd); }
                });
            }
        })();

        // OJO registro
        (function () {
            const btn1 = document.getElementById('togglePasswordReg');
            const in1 = document.getElementById('passwordHashReg');
            const i1 = btn1 ? btn1.querySelector('i') : null;

            const btn2 = document.getElementById('toggleConfirmPassword');
            const in2 = document.getElementById('confirmarPasswordHashReg');
            const i2 = btn2 ? btn2.querySelector('i') : null;

            function hook(btn, input, icon) {
                if (!btn || !input) return;
                btn.addEventListener('click', function () {
                    const isPwd = input.type === 'password';
                    input.type = isPwd ? 'text' : 'password';
                    if (icon) { icon.classList.toggle('bi-eye', isPwd); icon.classList.toggle('bi-eye-slash', !isPwd); }
                });
            }
            hook(btn1, in1, i1);
            hook(btn2, in2, i2);
        })();
    </script>

    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/jquery-validation/dist/localization/messages_es.js"></script>
}
